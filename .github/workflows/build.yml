name: LineageOS-action-build

on:
    workflow_dispatch:

jobs:
    build:
      runs-on: ubuntu-20.04
      steps:
      - name: Install the build packages
        run: 
           sudo apt update && sudo apt -y install bc bison build-essential ccache curl flex g++-multilib gcc-multilib git git-lfs gnupg gperf imagemagick
           lib32ncurses5-dev lib32readline-dev lib32z1-dev libelf-dev liblz4-tool libncurses5 libncurses5-dev
           libsdl1.2-dev libssl-dev libxml2 libxml2-utils lzop pngcrush rsync
           schedtool squashfs-tools xsltproc
           zip zlib1g-dev python3

      - name: Install the platform-tools
        run: 
            curl https://dl.google.com/android/repository/platform-tools-latest-linux.zip
            unzip platform-tools_r34.0.3-linux.zip -d ~
            


      - name: install repo
        run: 
            mkdir -p ~/bin
            curl https://storage.googleapis.com/git-repo-downloads/repo > ~/bin/repo
            sudo cp ~/bin/repo /bin/repo
            sudo chmod a+x /bin/repo

      - name: setting user-git
        run: 
            git config --global user.email git@github.com
            git config --global user.email github

      - name: Syncing LineageOS sources
        run: 
            mkdir ~/android
            cd ~/android
            screen -S sync
            repo init -u https://github.com/LineageOS/android.git -b lineage-17.1
            repo sync
            screen -R sync

      - name: build lineageos
        run: 







